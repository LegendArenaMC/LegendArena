package net.thenamedev.legendarena.listeners;import net.thenamedev.legendapi.utils.ChatUtils;import net.thenamedev.legendapi.utils.Rank;import net.thenamedev.legendarena.LegendArena;import org.bukkit.ChatColor;import org.bukkit.event.EventHandler;import org.bukkit.event.EventPriority;import org.bukkit.event.Listener;import org.bukkit.event.player.AsyncPlayerChatEvent;/** * @author ThePixelDev */public class ChatListener implements Listener {    @EventHandler(priority = EventPriority.HIGHEST, ignoreCancelled = false)    public void onChat(AsyncPlayerChatEvent ev) {        boolean isStaff = Rank.getRank(ev.getPlayer(), Rank.Helper);        if(LegendArena.isChatMuted() && !isStaff) {            ev.setCancelled(true);            ev.getPlayer().sendMessage(ChatColor.RED + "Chat is globally muted!");        } else            ev.setFormat(ChatUtils.getFormattedChat(ev.getMessage(), ev.getPlayer()));    }}